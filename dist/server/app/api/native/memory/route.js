(()=>{var e={};e.id=283,e.ids=[283],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},15848:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>N,routeModule:()=>b,serverHooks:()=>S,workAsyncStorage:()=>D,workUnitAsyncStorage:()=>U});var o={};r.r(o),r.d(o,{GET:()=>M,POST:()=>x});var n=r(96559),a=r(48088),i=r(37719),s=r(32190),c=function(e){return e[e.NONE=0]="NONE",e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH",e[e.AGGRESSIVE=4]="AGGRESSIVE",e[e.NORMAL=0]="NORMAL",e[e.CRITICAL=4]="CRITICAL",e}({}),l=r(90151);async function u(e=!1){try{(0,l.fH)(`[DOM] 정리 시작 (적극적 정리: ${e})`);let t=0;if("undefined"==typeof document)return!1;return t+=function(){try{return 0}catch(e){return(0,l.JE)("[DOM] 이벤트 리스너 정리 오류",e),0}}(),t+=function(e){try{let t=0;return document.querySelectorAll('[hidden], .hidden, [style*="display: none"], [style*="visibility: hidden"]').forEach(r=>{r instanceof HTMLElement&&(e&&!r.dataset.preserveContent&&(r.innerHTML="",t++),r.querySelectorAll("img").forEach(e=>{e.src&&!e.dataset.preserveSrc&&(e.dataset.originalSrc=e.src,e.src="",t++)}))}),t}catch(e){return(0,l.JE)("[DOM] 숨겨진 요소 최적화 오류",e),0}}(e),e&&(t+=function(){try{let e=0,t=window.innerHeight,r=window.innerWidth;return document.querySelectorAll(".optimize-when-offscreen, [data-optimize-offscreen]").forEach(o=>{if(o instanceof HTMLElement){let n=o.getBoundingClientRect(),a=n.bottom<0||n.top>t||n.right<0||n.left>r;a&&!o.dataset.optimized?(o.dataset.optimized="true",o.dataset.originalDisplay=o.style.display||"",o.style.display="none",e++):a||"true"!==o.dataset.optimized||(o.style.display=o.dataset.originalDisplay||"",delete o.dataset.optimized)}}),e}catch(e){return(0,l.JE)("[DOM] 화면 밖 요소 최적화 오류",e),0}}()),(0,l.fH)(`[DOM] 정리 완료: ${t}개 요소 최적화됨`),!0}catch(e){return(0,l.JE)("[DOM] 정리 중 오류 발생",e),!1}}var m=r(95301);(function(){var e=Error("Cannot find module './cache-optimizer'");throw e.code="MODULE_NOT_FOUND",e})(),function(){var e=Error("Cannot find module './event-optimizer'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module './resource-optimizer'");throw e.code="MODULE_NOT_FOUND",e}(),function(){var e=Error("Cannot find module './emergency-recovery'");throw e.code="MODULE_NOT_FOUND",e}();async function d(e,t){switch(m.logger.info(`[Optimization Utils] Running optimization at level: ${e}, emergency: ${t}`),e){case c.LOW:await Object(function(){var e=Error("Cannot find module './cache-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())();break;case c.MEDIUM:await Object(function(){var e=Error("Cannot find module './cache-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())(),await u(!1);break;case c.HIGH:await Object(function(){var e=Error("Cannot find module './cache-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())(),await u(!0),await Object(function(){var e=Error("Cannot find module './event-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())(),await Object(function(){var e=Error("Cannot find module './resource-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())();break;case c.AGGRESSIVE:case c.CRITICAL:case c.EXTREME:await Object(function(){var e=Error("Cannot find module './cache-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())(),await u(!0),await Object(function(){var e=Error("Cannot find module './event-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())(),await Object(function(){var e=Error("Cannot find module './resource-optimizer'");throw e.code="MODULE_NOT_FOUND",e}())();break;default:m.logger.warn(`[Optimization Utils] Unknown optimization level: ${e}`)}t&&(m.logger.info("[Optimization Utils] Performing emergency optimizations"),await Object(function(){var e=Error("Cannot find module './emergency-recovery'");throw e.code="MODULE_NOT_FOUND",e}())())}let p={isInitialized:!1,isAvailable:!1,lastError:null,lastCheck:0,errorCount:0};async function f(){try{let e=Date.now();if(e-p.lastCheck<1e4&&p.isInitialized)return p.isAvailable;let t=await fetchMemoryInfo();return p.isAvailable=t.success,p.isInitialized=!0,p.lastCheck=e,t.success?p.lastError=null:p.lastError=Error(t.error||"Unknown error in native bridge"),p.isAvailable}catch(e){return p.isAvailable=!1,p.isInitialized=!0,p.lastError=e instanceof Error?e:Error(String(e)),p.lastCheck=Date.now(),!1}}async function g(){try{return h()}catch(e){return console.error("메모리 정보 가져오기 오류:",e),h()}}function h(){return{heap_used:0x3200000,heap_total:0x6400000,heap_limit:0xc800000,heap_used_mb:Math.round(500)/10,rss:Math.round(0x9600000),rss_mb:Math.round(1500)/10,percent_used:50,timestamp:Date.now()}}async function y(e=!1){let t=performance.now(),r=E();try{(0,l.fH)(`[GC] 가비지 컬렉션 제안${e?" (긴급)":""}`),e&&function(){try{Array(1e6).fill(0).map(()=>({}))}catch(e){}}();let o=performance.now(),n=E(),a=Math.max(0,r.jsHeapSize-n.jsHeapSize);return{success:!0,freedMemory:a,freedMB:a/1048576,duration:o-t,timestamp:Date.now()}}catch(e){return(0,l.vV)("[GC] 가비지 컬렉션 오류",e),{success:!1,freedMemory:0,freedMB:0,duration:performance.now()-t,timestamp:Date.now(),error:e instanceof Error?e.message:String(e)}}}function E(){return{jsHeapSize:0,totalJSHeapSize:0,jsHeapSizeLimit:0}}async function O(e=c.MEDIUM,t=!1){try{m.logger.info(`[Memory Optimizer] Starting memory optimization at level: ${e}, emergency: ${t}`);let r=await g();await d(e,t),await y(t);let o=await g(),n=r&&o&&void 0!==r.heapUsed&&void 0!==o.heapUsed?r.heapUsed-o.heapUsed:0;return m.logger.info(`[Memory Optimizer] Memory optimization completed. Freed: ${n} bytes`),{optimizationLevel:e,level:e,memoryFreed:n,timestamp:Date.now(),success:!0}}catch(t){return m.logger.error("[Memory Optimizer] Error during memory optimization:",t instanceof Error?{message:t.message,stack:t.stack}:{}),{optimizationLevel:e,level:e,memoryFreed:0,timestamp:Date.now(),success:!1,error:t instanceof Error?t.message:String(t)}}}function w(e,t=2){if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}let v={LOW:"low",MEDIUM:"medium",HIGH:"high",EXTREME:"extreme"};async function M(){try{let e=await g();if(!e)return s.NextResponse.json({success:!1,error:"메모리 정보를 가져올 수 없습니다."},{status:404});return s.NextResponse.json({success:!0,data:{...e,heapUsedFormatted:w(e.heapUsed??0),heapTotalFormatted:w(e.heapTotal??0),rssFormatted:w(e.rss??0)}})}catch(e){return console.error("Error fetching memory info:",e),s.NextResponse.json({success:!1,error:e instanceof Error?e.message:String(e)},{status:500})}}async function x(e){try{let{level:t="medium",emergency:r=!1}=await e.json(),o=Object.values(v).includes(t)?t:v.MEDIUM,n=await O(o,r),a=await g();if(!a)return s.NextResponse.json({success:!0,result:n,error:"최적화 후 메모리 정보를 가져올 수 없습니다."});return s.NextResponse.json({success:!0,result:n,memoryInfo:{...a,heapUsedFormatted:w(a.heapUsed??0),heapTotalFormatted:w(a.heapTotal??0),rssFormatted:w(a.rss??0)}})}catch(e){return console.error("Error optimizing memory:",e),s.NextResponse.json({success:!1,error:e instanceof Error?e.message:String(e)},{status:500})}}let b=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/native/memory/route",pathname:"/api/native/memory",filename:"route",bundlePath:"app/api/native/memory/route"},resolvedPagePath:"C:\\Users\\user\\Desktop\\loop\\src\\app\\api\\native\\memory\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:D,workUnitAsyncStorage:U,serverHooks:S}=b;function N(){return(0,i.patchFetch)({workAsyncStorage:D,workUnitAsyncStorage:U})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},90151:(e,t,r)=>{"use strict";r.d(t,{FY:()=>n,JE:()=>c,fH:()=>s,gq:()=>a,vV:()=>l});var o=r(95301),n=function(e){return e.CONVERSATION="conversation",e.ERROR="error",e.PERFORMANCE="performance",e.MEMORY="memory",e.SYSTEM="system",e}({});async function a(e={}){try{let t=new URLSearchParams;e.type&&(Array.isArray(e.type)?e.type.forEach(e=>t.append("type",e)):t.set("type",e.type)),e.startTime&&t.set("startTime",e.startTime.toString()),e.endTime&&t.set("endTime",e.endTime.toString()),e.query&&t.set("query",e.query),e.limit&&t.set("limit",e.limit.toString()),e.offset&&t.set("offset",e.offset.toString()),e.sessionId&&t.set("sessionId",e.sessionId),e.tags&&e.tags.length>0&&e.tags.forEach(e=>t.append("tag",e));let r=await fetch(`/api/logs/search?${t.toString()}`);if(!r.ok)throw Error(`로그 검색 실패: ${r.status} ${r.statusText}`);let n=await r.json();return o.logger.debug(`로그 검색 완료 (결과 수: ${n.data.length})`),n.data}catch(e){throw o.logger.error("로그 검색 중 오류 발생:",e),e}}function i(e){try{if("undefined"==typeof localStorage)return;let t={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,5)},r=localStorage.getItem("application_logs"),o=r?JSON.parse(r):[];o.push(t),o.length>1e3&&o.splice(0,o.length-1e3),localStorage.setItem("application_logs",JSON.stringify(o))}catch(e){console.error("로그 항목 저장 실패:",e)}}function s(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.info(`[Info] ${e}`,r),i({level:"info",message:e,data:r,timestamp:Date.now(),sessionId:u()})}function c(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.warn(`[Warning] ${e}`,r),i({level:"warn",message:e,data:r,timestamp:Date.now(),sessionId:u()})}function l(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.error(`[Error] ${e}`,r),i({level:"error",message:e,data:r,timestamp:Date.now(),sessionId:u()})}function u(){if("undefined"!=typeof localStorage)return localStorage.getItem("session_id")||void 0}},95301:()=>{throw Error("Module build failed (from ./node_modules/next/dist/build/webpack/loaders/next-swc-loader.js):\nError:   \x1b[31m\xd7\x1b[0m Expression expected\n     ╭─[\x1b[36;1;4mC:\\Users\\user\\Desktop\\loop\\src\\app\\utils\\memory\\logger.ts\x1b[0m:410:1]\n \x1b[2m407\x1b[0m │   const avgUsage = usages.reduce((sum, usage) => sum + usage, 0) / usages.length;\n \x1b[2m408\x1b[0m │   const peakUsage = Math.max(...usages);\n \x1b[2m409\x1b[0m │   const minUsage = Math.min(...usages);\n \x1b[2m410\x1b[0m │     .slice(0, limit);\n     \xb7 \x1b[35;1m    ─\x1b[0m\n \x1b[2m411\x1b[0m │ }\n \x1b[2m412\x1b[0m │ \n \x1b[2m412\x1b[0m │ /**\r\n     ╰────\n\n\nCaused by:\n    Syntax Error")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[447,580],()=>r(15848));module.exports=o})();