(()=>{var e={};e.id=518,e.ids=[518],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44705:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>x,routeModule:()=>m,serverHooks:()=>y,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{GET:()=>p});var o=r(96559),a=r(48088),n=r(37719),i=r(32190),l=r(79748),u=r(33873),c=r(90151);async function p(e){try{let{searchParams:t}=new URL(e.url),r={type:t.get("type")||void 0,startTime:t.get("startTime")?parseInt(t.get("startTime")||"0"):void 0,endTime:t.get("endTime")?parseInt(t.get("endTime")||"0"):void 0,query:t.get("query")||void 0,limit:t.get("limit")?parseInt(t.get("limit")||"100"):100,offset:t.get("offset")?parseInt(t.get("offset")||"0"):0,sessionId:t.get("sessionId")||void 0},s=t.getAll("tag");s.length>0&&(r.tags=s);let o=t.getAll("type");o.length>1&&(r.type=o);let a=await d(r);return i.NextResponse.json({success:!0,count:a.length,data:a})}catch(e){return console.error("로그 검색 중 오류:",e),i.NextResponse.json({success:!1,error:e instanceof Error?e.message:"로그 검색 중 알 수 없는 오류가 발생했습니다."},{status:500})}}async function d(e){try{let t=Array.isArray(e.type)?e.type:e.type?[e.type]:Object.values(c.FY),r=[];for(let s of t){let t=(0,u.join)(process.cwd(),"public","logs",s);try{for(let s of(await (0,l.readdir)(t)).filter(t=>{if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return!1;if(e.startTime||e.endTime){let[r,s,o]=t.split("-").map(Number),a=new Date(r,s-1,o).getTime();if(e.startTime&&a<e.startTime||e.endTime&&a>e.endTime)return!1}return!0})){let o=(0,u.join)(t,s);try{for(let t of(await (0,l.readdir)(o)))if(t.endsWith(".json"))try{let s=await (0,l.readFile)((0,u.join)(o,t),"utf-8"),a=JSON.parse(s);if(e.startTime&&a.timestamp<e.startTime||e.endTime&&a.timestamp>e.endTime||e.sessionId&&a.sessionId!==e.sessionId||e.tags&&e.tags.length>0&&(!a.tags||!e.tags.some(e=>a.tags?.includes(e))))continue;if(e.query){let t=e.query.toLowerCase(),r=(a.content||"").toLowerCase(),s=a.metadata?JSON.stringify(a.metadata).toLowerCase():"";if(!r.includes(t)&&!s.includes(t))continue}r.push(a)}catch(e){console.error(`로그 파일 읽기 오류 (${t}):`,e)}}catch(e){console.error(`날짜 디렉토리 처리 중 오류 (${s}):`,e)}}}catch(e){console.error(`타입 디렉토리 처리 중 오류 (${s}):`,e)}}r.sort((e,t)=>t.timestamp-e.timestamp);let s=e.offset||0,o=e.limit||100;return r.slice(s,s+o)}catch(e){throw console.error("파일 시스템 로그 검색 중 오류:",e),e}}let m=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/logs/search/route",pathname:"/api/logs/search",filename:"route",bundlePath:"app/api/logs/search/route"},resolvedPagePath:"C:\\Users\\user\\Desktop\\loop\\src\\app\\api\\logs\\search\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:f,serverHooks:y}=m;function x(){return(0,n.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:f})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79748:e=>{"use strict";e.exports=require("fs/promises")},90151:(e,t,r)=>{"use strict";r.d(t,{FY:()=>o,JE:()=>l,fH:()=>i,gq:()=>a,vV:()=>u});var s=r(95301),o=function(e){return e.CONVERSATION="conversation",e.ERROR="error",e.PERFORMANCE="performance",e.MEMORY="memory",e.SYSTEM="system",e}({});async function a(e={}){try{let t=new URLSearchParams;e.type&&(Array.isArray(e.type)?e.type.forEach(e=>t.append("type",e)):t.set("type",e.type)),e.startTime&&t.set("startTime",e.startTime.toString()),e.endTime&&t.set("endTime",e.endTime.toString()),e.query&&t.set("query",e.query),e.limit&&t.set("limit",e.limit.toString()),e.offset&&t.set("offset",e.offset.toString()),e.sessionId&&t.set("sessionId",e.sessionId),e.tags&&e.tags.length>0&&e.tags.forEach(e=>t.append("tag",e));let r=await fetch(`/api/logs/search?${t.toString()}`);if(!r.ok)throw Error(`로그 검색 실패: ${r.status} ${r.statusText}`);let o=await r.json();return s.logger.debug(`로그 검색 완료 (결과 수: ${o.data.length})`),o.data}catch(e){throw s.logger.error("로그 검색 중 오류 발생:",e),e}}function n(e){try{if("undefined"==typeof localStorage)return;let t={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,5)},r=localStorage.getItem("application_logs"),s=r?JSON.parse(r):[];s.push(t),s.length>1e3&&s.splice(0,s.length-1e3),localStorage.setItem("application_logs",JSON.stringify(s))}catch(e){console.error("로그 항목 저장 실패:",e)}}function i(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.info(`[Info] ${e}`,r),n({level:"info",message:e,data:r,timestamp:Date.now(),sessionId:c()})}function l(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.warn(`[Warning] ${e}`,r),n({level:"warn",message:e,data:r,timestamp:Date.now(),sessionId:c()})}function u(e,t){let r=t&&"object"==typeof t?{...t}:void 0!==t?{value:t}:{};console.error(`[Error] ${e}`,r),n({level:"error",message:e,data:r,timestamp:Date.now(),sessionId:c()})}function c(){if("undefined"!=typeof localStorage)return localStorage.getItem("session_id")||void 0}},95301:()=>{throw Error("Module build failed (from ./node_modules/next/dist/build/webpack/loaders/next-swc-loader.js):\nError:   \x1b[31m\xd7\x1b[0m Expression expected\n     ╭─[\x1b[36;1;4mC:\\Users\\user\\Desktop\\loop\\src\\app\\utils\\memory\\logger.ts\x1b[0m:410:1]\n \x1b[2m407\x1b[0m │   const avgUsage = usages.reduce((sum, usage) => sum + usage, 0) / usages.length;\n \x1b[2m408\x1b[0m │   const peakUsage = Math.max(...usages);\n \x1b[2m409\x1b[0m │   const minUsage = Math.min(...usages);\n \x1b[2m410\x1b[0m │     .slice(0, limit);\n     \xb7 \x1b[35;1m    ─\x1b[0m\n \x1b[2m411\x1b[0m │ }\n \x1b[2m412\x1b[0m │ \n \x1b[2m412\x1b[0m │ /**\r\n     ╰────\n\n\nCaused by:\n    Syntax Error")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(44705));module.exports=s})();